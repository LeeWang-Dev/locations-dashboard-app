{"version":3,"sources":["services/cluster.js","utils/constants.js","components/locations-dashboard/Map.js","assets/images/marker-icon.png","components/locations-dashboard/Main.js","components/App.js","reportWebVitals.js","index.js"],"names":["getClusters","params","a","result","url","axios","get","then","response","data","catch","err","status","message","mapboxgl","workerClass","require","default","useStyles","makeStyles","mapContainer","display","Map","classes","mapRef","useRef","useState","longitude","latitude","zoom","viewport","setViewport","type","features","clusterSource","setClusterSource","useEffect","map","current","getMap","timeout","loadImage","error","image","addImage","on","clearTimeout","setTimeout","getZoom","bounds","getBounds","toArray","flat","res","forEach","feature","abbr","numeral","properties","format","toUpperCase","className","width","height","mapStyle","mapboxApiAccessToken","ref","attributionControl","maxZoom","onViewportChange","interactiveLayerIds","onClick","e","length","layer","id","geometry","coordinates","transitionDuration","source","filter","paint","layout","style","bottom","left","root","Main","theme","createTheme","App","ThemeProvider","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a13cb4fc.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport { BASE_URL } from \"../utils/constants.js\";\r\n\r\nexport const getClusters = async (params) => {\r\n    var result = null;\r\n    \r\n    let url = `${BASE_URL}/api/clusters`;\r\n  \r\n    await axios.get(url,{\r\n      params: params || {}\r\n    }).then((response) => {\r\n        result = response.data;\r\n    }).catch((err) => {\r\n      result = {\r\n        status: \"failed\",\r\n        message: \"No internet connection\",\r\n      };\r\n    });\r\n    return result;\r\n  };","\r\n//export const BASE_URL = 'http://localhost:8080';\r\n\r\nexport const BASE_URL = 'https://locations-dashboard.herokuapp.com';\r\n\r\nexport const MAPBOX_ACCESS_TOKEN = 'pk.eyJ1IjoibGVld2FuZ2RldiIsImEiOiJja2tnbDU2c2gwMHNvMndsdDF1d2pxNTQ2In0.zKeo06DtCh6fLifrbCZCFA';\r\n","import React, { useState, useEffect, useRef } from 'react';\r\n\r\nimport { makeStyles } from '@mui/styles';\r\n\r\nimport ReactMapGL, { Source, Layer, ScaleControl } from 'react-map-gl';\r\nimport 'mapbox-gl/dist/mapbox-gl.css';\r\nimport mapboxgl from \"mapbox-gl\";\r\n\r\nimport numeral from \"numeral\";\r\n\r\nimport { MAPBOX_ACCESS_TOKEN } from \"../../utils/constants.js\";\r\nimport { getClusters } from \"../../services/cluster.js\";\r\n\r\nimport iconMarker from \"../../assets/images/marker-icon.png\";\r\n\r\nmapboxgl.workerClass = require(\"worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker\").default;\r\n\r\nconst useStyles = makeStyles({\r\n   mapContainer:{\r\n      '& .mapboxgl-ctrl-logo': {\r\n         display: 'none'\r\n       }\r\n   }\r\n});\r\n\r\nfunction Map() {\r\n    const classes = useStyles();\r\n    const mapRef = useRef(null);\r\n    const [viewport, setViewport] = useState({\r\n        longitude: 0,\r\n        latitude: 0,\r\n        zoom: 1\r\n    });\r\n\r\n    const [clusterSource, setClusterSource] = useState({\r\n        type: 'FeatureCollection',\r\n        features:[]\r\n    });\r\n    //const [mapCursor, setMapCursor] = useState('default');\r\n    \r\n    const handleViewport = (viewport) => {\r\n        setViewport(viewport);\r\n    }\r\n    /*\r\n    const handleMouseMove = (e) => {\r\n        let features = mapRef.current.queryRenderedFeatures([[e.point[0] - 5, e.point[1] - 5], [e.point[0] + 5, e.point[1] + 5]]);\r\n        if(features.length>0){\r\n           setMapCursor('pointer');\r\n        }else{\r\n           setMapCursor('default');\r\n        }\r\n    }\r\n    */ \r\n    const handleClick = (e) => {\r\n        if(e.features && e.features.length>0){\r\n            const feature = e.features[0];\r\n            if(feature.layer.id === 'cluster-layer'){\r\n                setViewport({\r\n                    ...viewport,\r\n                    longitude: feature.geometry.coordinates[0],\r\n                    latitude: feature.geometry.coordinates[1],\r\n                    zoom: viewport.zoom + 1,\r\n                    transitionDuration: 500\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    useEffect(()=>{\r\n\r\n        const map = mapRef.current.getMap();\r\n\r\n        let timeout = null;\r\n\r\n        map.loadImage(iconMarker, (error, image) => {\r\n            if (error) throw error;\r\n            // Add the image to the map style.\r\n            map.addImage('marker-icon', image);\r\n        });\r\n\r\n        map.on('moveend', mapDataCallback);\r\n\r\n        function mapDataCallback(){\r\n            if(timeout){\r\n                clearTimeout(timeout);\r\n            }\r\n            timeout = setTimeout(async () => {\r\n               let res = await getClusters({\r\n                   zoom: map.getZoom(),\r\n                   bounds: map.getBounds().toArray().flat()\r\n               });\r\n               if(res.status === 'success'){\r\n                   if(res.result && res.result.features){\r\n                        res.result.features.forEach(feature => {\r\n                            var abbr = numeral(feature.properties[\"point_count\"]).format(\"0.[0] a\").toUpperCase();\r\n                            if(feature.properties[\"point_count\"]>=1000){\r\n                            abbr += '+';\r\n                            }\r\n                            feature.properties[\"point_count_abbreviated\"] = abbr;\r\n                        });\r\n                        setClusterSource(res.result);\r\n                   }\r\n               }\r\n            }, 500);\r\n        }\r\n\r\n    }, []);\r\n\r\n    return (\r\n        <ReactMapGL className={classes.mapContainer}\r\n            {...viewport}    \r\n            width=\"100%\"\r\n            height=\"100%\"\r\n            mapStyle=\"mapbox://styles/mapbox/light-v10\"\r\n            mapboxApiAccessToken={MAPBOX_ACCESS_TOKEN}\r\n            ref={mapRef}\r\n            attributionControl={false}\r\n            maxZoom={24}\r\n            //minZoom={16}\r\n            //maxPitch={0}\r\n            //dragPan={dragPan}\r\n            //preserveDrawingBuffer={true}\r\n            //dragRotate={false}\r\n            //transitionDuration={100}\r\n            onViewportChange={handleViewport}\r\n            interactiveLayerIds={['cluster-layer','unclustered-point-layer']}\r\n            //getCursor={() => mapCursor}\r\n            //onMouseMove={handleMouseMove}\r\n            onClick={handleClick}\r\n            //onMouseDown={handleMouseDown}\r\n            //onMouseUp={handleMouseUp}\r\n            //onTouchStart={handleMouseDown}\r\n            //onTouchMove={handleMouseMove}\r\n            //onTouchEnd={handleMouseUp}\r\n        >\r\n            <Source\r\n                id=\"clusterSource\"\r\n                type=\"geojson\"\r\n                data={clusterSource}\r\n                //cluster={true}\r\n                //clusterMaxZoom={14}\r\n                //clusterRadius={50}\r\n            >\r\n                <Layer\r\n                    id='cluster-layer'\r\n                    type='circle'\r\n                    source='clusterSource'\r\n                    filter={['>', 'point_count', 1]}\r\n                    paint={{\r\n                    'circle-color': ['step', ['get', 'point_count'], '#51bbd6', 100, '#f1f075', 750, '#f28cb1'],\r\n                    'circle-radius': ['step', ['get', 'point_count'], 20, 100, 30, 750, 40]\r\n                    }}\r\n                />\r\n                <Layer \r\n                    id='cluster-count-layer'\r\n                    type='symbol'\r\n                    source='clusterSource'\r\n                    filter={['>', 'point_count', 1]}\r\n                    layout={{\r\n                        'text-field': '{point_count_abbreviated}',\r\n                        'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],\r\n                        'text-size': 12\r\n                    }}\r\n                />\r\n                <Layer\r\n                    id='unclustered-point-layer'\r\n                    type='symbol'\r\n                    source='clusterSource'\r\n                    filter={['==', 'point_count', 1]}\r\n                    layout={{\r\n                        'icon-image': 'marker-icon',\r\n                        'icon-size': 0.6,\r\n                        'icon-rotate': [\"get\",\"heading\"]\r\n                    }}\r\n                />\r\n            </Source>\r\n            <ScaleControl \r\n                style={{bottom:10,left:10}} />\r\n        </ReactMapGL>\r\n    );\r\n}\r\n\r\nexport default Map;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAyCAMAAAAKuilWAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAj1QTFRFAAAAOLC4/4qK/4qK/4qK/oqK/oqK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qKOLC4OLC4OLC4OLC4OLC4/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qK/4qKOLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4/4qK/4qK/4qK/4qK/4qKOLC4OLC4OLC4OLC4OLC4OLC4OLC4/4qK/4qK/4qKOLC4OLC4OLC4OLC4OLC4/4qK/4qK/4qKOLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4OLC4VkSAhwAAAL90Uk5TAAAJgbcodv/CBxrn/muw8hhClgXS/VYBiNEOIOxmBLv5LlerCNxRnOAUNPeJAMz7N2y+F+93r+k/+I0SyplgMRMDAg0lT4DL9VT81XMhCRIUDgIRTrPPBgr0hAsaYrfd5+njzYI0AUR49tc1Oa/6/9RnBRBIgwqF/cokk9NJEL/+60MIvO48A60dTZwGuvA+WaTx4DYNaIspkx/70iiW6jfvjablLS/2fHDFC4zWfcZQ2/WKYdn87ZQbbJGomkgzCm4xAAAB9ElEQVR4nGNgIBkw4pVlYmZhxaubjZ2dgxOPAi5udnYeXjwK+NiBgF8Ap7wgOxgICeOQFxCBKBAVwy4vLsEOBZJSWBVIy8AU8Mhik5eTZ4cDBUUsCpR4EArYlcUx5FVUkeTZRdUwXKjOjgI0NNEUaGmjKmDX0UV1oR6aPLu+AYoCQ3R5dnYjZHcam2AqYDdFyAubYZFnN5eGK7CwxKaA3QrmTmsbMJ/b1s7ewdHJ2cXVzV0UJODhCZFndPMCBr+3j68TA6Off0BgEINucEgoyNCwcLCCiEhg4EdFMzDExMbFJyQmJaekpjE4pWsAVWSAFQRnsmdlMzDk5Oblw0BBYRFDsboou4gjWEVJqSZDWXlFPjKorGJwrK6phfujrr4hHxU0NjHoOsHlm1vyMUBrGyKg2jsw5fPzEzvhCrrysCnI726Hyvf0YpXP7+uHKpiA3YD8/Fyogok45PMnNUMUTMalIH8KWH4qehAgwDSwgiqc8vnTwQpm4FYwE6xgFm4F5ZBgmI1TwQSIL+bgVDAXomAeLvn50LBesBCHgkWwyFyMXX7JUlhsLluOVcEKeHQzrsQWmKtWI1IMwxpM+bUBSPIMResq0OTXdzKggLQNG5GlN22eyoAOerZs3QaV3r5jJ4Y0ON5Td+2euGfvin0xaVjlsQMAFN44ROMgIzgAAAAASUVORK5CYII=\"","import React from 'react';\r\n\r\nimport { makeStyles } from '@mui/styles';\r\n\r\nimport Map from \"./Map.js\";\r\n\r\nconst useStyles = makeStyles({\r\n   root:{\r\n      width:'100vw',\r\n      height:'100vh'\r\n   }\r\n});\r\n\r\nfunction Main() {\r\n    const classes = useStyles();\r\n    return (\r\n       <div className={classes.root}>\r\n           <Map />\r\n       </div>\r\n    );\r\n}\r\n\r\nexport default Main;","import React from 'react';\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\n\nimport Locations_Dashboard from \"./locations-dashboard/Main.js\";\n\nconst theme = createTheme();\n\nfunction App() {\n  return (\n    <ThemeProvider theme={theme}>\n       <Locations_Dashboard />\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}